var articleId=$("#articleId").val();var isLike=false;var likeFlag=$("#likeFlag").val();if(likeFlag){setLikeImagToGray();isLike=true}var isLogin=$("#isLogin");$(function(){$.scrollUp({scrollName:"scrollUp",topDistance:"200",topSpeed:300,animation:"fade",animationInSpeed:200,animationOutSpeed:200,scrollText:"返回顶部",activeOverlay:false,})});$(function(){var b=$("#cdnUrl").val();var e=b+"/static/plugins/ueditor1_4_3-utf8-jsp/third-party/SyntaxHighlighter/shCore.js";var j=b+"/static/plugins/ueditor1_4_3-utf8-jsp/third-party/SyntaxHighlighter/shCoreDefault.css";uParse("#articleContext",{highlightJsUrl:e,highlightCssUrl:j});$("#headNav li").css("clear","none");var d=$("#articleKeywords").text();var h=d.split(",");var f="";for(var c=0;c<h.length;c++){var g=h[c];var a="http://so.blog.yemou.net/cse/search?q="+encodeURIComponent(g)+"&click=1&s=17470874779923938404&nsid=";f+="<span class='keyword'><a target='_blank' href="+a+">"+g+"<a/></span>"}$("#articleKeywords").html("标签："+f);if(!articleId){return}if(isLogin.val()&&isLogin.val()!=1){Alert.defaultAlert("非法操作！");return}if(!isLogin.val()){$("#addComment").html("您还没有登录，<a href='/user/login'>登录</a>即可参与评论~~");$("#addComment").css({"font-size":"16px","text-align":"center","font-family":"宋体"});$("#submitComment").css({display:"none"})}initCommentList()});$(function(){$("#submitArticle").click(function(){var a="/article/manage/save_article";$.ajax({type:"POST",url:a,data:{articleId:articleId,status:0},success:function(b){var c=commonHandler.jsonHandler(b,false);location.href="/article/query/info/"+c}})});$(".likeAction").click(function(){if(isLike!=false){return}if($(".editArticle").is("span")){Alert.defaultAlert("您就别给自己点赞啦~~");return}isLike=true;setLikeImagToGray();var d=$(this).next();if(d){var e=Number(d.text())+1;$(d).text(e);$(d).css("color","#E23A3B")}else{return}var a="like";if($(this).attr("id")=="disLikeImg"){a="disLike"}var b="/article/operation/like";if(!articleId){return}var c={likeType:a,articleId:articleId};$.ajax({type:"POST",data:c,url:b,success:function(f){commonHandler.jsonHandler(f,false)}})});$("#submitComment").click(function(){var b=$("#commentContext").val();if(!b||b.replace(/(^\s*)|(\s*$)/g,"").length==0){$("#commentValidate").text("请输入评论内容！");$("#commentValidate").css({color:"red","font-size":"12px"});return}var c="/comment/manage/add";var a={articleId:articleId,commentContext:b};$.ajax({type:"POST",data:a,url:c,success:function(d){commonHandler.jsonHandler(d,false);$("#commentContext").val("");$("#commentValidate").empty();initCommentList()}})});$(".keyword").mouseover(function(){$(this).css("background-color","#226929")});$(".keyword").mouseout(function(){$(this).css("background-color","#BBBFAD")})});function initCommentList(){var f="/comment/query/list";var e={articleId:articleId};var d=renderCommentList(f,e);if(!d||d.totalSize==0){$("#commentList").html("还没有评论，快来抢沙发吧~~");$("#commentList").css({"font-size":"14px","text-align":"center","font-family":"宋体","margin-bottom":"40px"});return}var a=d.totalPage;if(a==1){return}var c=d.currentPage;var b=commonHandler.getPagineOptions("center",a,null,c);b.onPageChanged=function(h,i,g){e.page=g;renderCommentList(f,e)};commonHandler.bootstrapPaginator($("#pagination"),b);return d}function renderCommentList(c,b){$("#commentList").empty();var a;$.ajax({type:"POST",async:false,data:b,url:c,success:function(d){var f=commonHandler.jsonHandler(d,false);if(!f){return}var e=f.dataList;a=f.pageInfo;if(!e||e.length==0||!a){return}var g="";$.each(e,function(h,j){var i="<div class='commentItem'><div class='commentHeader'><span class='commentUser'>"+j.userName+"</span>&nbsp;<span class='commentTime'>发表自&nbsp;"+j.createTime+"</span><span class='commentFloor'>"+j.floor+"楼</span></div><div class='commentContext'>"+j.commentContext+"</div></div>";g+=i});$("#commentList").append(g)}});return a}function setLikeImagToGray(){$(".likeAction").css({cursor:"auto"});var a=$("#likeImg").attr("src");if(!a){return}var b=a.substring(0,a.lastIndexOf("/")+1);$("#likeImg").attr("src",b+"like5.png");var d=$("#disLikeImg").attr("src");var c=d.substring(0,d.lastIndexOf("/")+1);$("#disLikeImg").attr("src",c+"like6.png")};