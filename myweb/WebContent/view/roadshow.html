<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>路况展示</title>
<link rel="stylesheet" type="text/css" href="../css/citytravel.css">
<script type="text/javascript" src="../js/jquery-1.9.1.min.js"></script>
<script src="http://webapi.amap.com/maps?v=1.3&key=78fba5ca323f7f58d8c9528500cf1b63" type="text/javascript"></script>
<style type="text/css">
body {
	font-size:12px;
	margin-left:1px;
}

div.all{
	width:1226px;
}
.btn{ 
	width:17px; 
	height:64px; 
	background:#F00;
	position:absolute; 
	left:250px;
	cursor:pointer; 
	background:url(../img/left.png);
	z-index:101
}
.trafficinfo{
	height:28px;
	float:right;
	padding:4px 20px 0px;
}
div.left{
	width:250px;
	float:left;
	border-right:solid 1px #B8BCC7;
	position: relative;
}
div.right{
	width:975px;
	float:left;
	margin-top:-30px; 
}
.left-top{
	width:225px;
	height:210px;
	position: absolute;
}
.left-bottom{
	width:225px;
	height:210px;
	position: absolute; 
	bottom: 0px;
}
div.linktop{
	float:left;
	width:1226px;
	height:20px;
	margin:0 auto;
	margin-bottom:0px;
}

div.linkfoot{
	float:left;
	width:1226px;
	height:20px;
	margin:0 auto;
	margin-bottom:0px;
}
.left-bottom-title{
	height:30px;
	background:#F5F5F5;
	line-height: 30px;
}
.left-bottom-conditions {
	height: 180px;
	width: 213px;
	margin-left: 10px;
}
.left-bottom-conditions1{
	height: 10px;
	width: 200px;
	margin-top:10px;
	background: url(../img/gthan40.png) no-repeat;
}
.left-bottom-conditions2{
	height: 10px;
	width: 200px;
	margin-top:10px;
	background: url(../img/20-40.png) no-repeat;
}
.left-bottom-conditions3{
	height: 10px;
	width: 200px;
	margin-top:10px;
	background: url(../img/lthan20.png) no-repeat;
}
.left-bottom-conditions4{
	height: 15px;
	width: 200px;
	margin-top:10px;
	background: url(../img/realtime.png) no-repeat;
}
.roadshowinfo{
	width:225px;
	height:175px;
}
.info{
	width:225px;
	height:50px;
	margin-top:10px;
}
.infotype{
	width:225px;
	height:12px;
	margin-left:10px;
}
.infomsg{
	width:225px;
	height:38px;
	margin-left:10px;
	word-wrap: break-word;
	word-break: normal;
	margin-top:2px;
}
.infotype span{
	font-weight:bold;
}
</style>
<script type="text/javascript">
$(function() {
	var mapObj; //初始化地图对象，加载地图
	var marker = new Array();
	var windowsArr = new Array();
	function mapInit() {
		mapObj = new AMap.Map("iCenter",{
			rotateEnable:true,
			dragEnable:true,
			zoomEnable:true,         //二维地图显示视口
			view: new AMap.View2D({
				center:new AMap.LngLat(113.51667,22.30000),//地图中心点
				zoom:12 //地图显示的缩放级别
			})
		});
	}
	function reinitIframe(){  
		var temp = 150;
		var hgt = window.screen.availHeight;
		var height = hgt - 120 - temp;
		$(".right").css("height", height>480?height:480);
		$("#iCenter").css("height", height>480?height:480);
		$(".btn").css("top", ((height>480?height:480)-20)/2);
		$(".left").css("height", (height>480?height:480) - 20);
	}
	
	
	function initmsg() {
		var i = 0;
		$(".roadshowinfo").empty();
		for(; i<3; i++) {
			$(".roadshowinfo").append("<div class='info' id='info" + i + "'>");
			$("#info" + i).append("<div class='infotype' id='infotype" + i + "'><span></span></div>");
			$("#infotype" + i + ">span").append("[榄港路封路" + i + "]");
			$("#info" + i).append("<div class='infomsg' id='infomsg" + i + "'><span></span></div>");
			$("#infomsg" + i + ">span").append(getInfo(i));
		}
	}
	
	reinitIframe();
	mapInit();
	initmsg();
	setInterval('autoScroll()',3000);
	//autoScroll();
});
var data = "{news:[{type:'实时路况', time:'2014年8月22日', add:'地址a', msg:'施工'}, {type:'交通事故', time:'2014年8月01日', add:'地址b', msg:'限行'},{type:'3', time:'2014年8月', add:'地址a', msg:'限行'},{type:'4', time:'2014年8月', add:'地址a', msg:'限行'},{type:'5', time:'2014年8月',add:'地址a', msg:'限行'},{type:'6', time:'2014年8月', add:'地址a', msg:'限行'},{type:'7', time:'2014年8月', add:'地址', msg:'限行'}]}";
var dataObj = eval("("+data+")");
function getInfo(i) {
	return "[" + dataObj.news[i].type + "] " + dataObj.news[i].time + "," + dataObj.news[i].add + ","  + dataObj.news[i].msg;
}
function autoScroll(){
	$(".roadshowinfo .info:first-child").remove();
	var i = $(".roadshowinfo .info:last-child").attr("id").substring(4);
	i++;
	if(i>6){
		i = 0;
	};
	$(".roadshowinfo").append("<div class='info' id='info" + i + "'>");
	$("#info" + i).append("<div class='infotype' id='infotype" + i + "'><span></span></div>");
	$("#infotype" + i + ">span").append("[榄港路封路" + i + "]");
	$("#info" + i).append("<div class='infomsg' id='infomsg" + i + "'><span></span></div>");
	$("#infomsg" + i + ">span").append(getInfo(i));
}
</script>
</head>
<body>
<div class="all">
		<div id="tools">
			<div id="MapInfoNav" class="tools_r">
				<a id="btn_home" class="toolBtn toolBtn--link toolBtn--img toolBtn--img--home" ><span class="toolBtn-cont"><span class="toolBtn-img"></span>首页</span></a>
			</div>
			<div class="tools_l" id="citytools">
				<a id="btn_home" class="toolBtn" ><span class="toolBtn-cont">晴转多云 33~28℃</span></a>
			</div>
			<div class="trafficinfo">
				<a class="toolBtn" ><span class="toolBtn-cont">[交通事故]:[06/08][梅花西路]两车相撞,西向东行驶缓慢</span></a>
			</div>
		</div>
		<div class="left">
			<div class="left-top">
				<div class="left-bottom-title" style="margin-top:15px;"><span style="margin-left:10px;">道路事故</span></div>
				<div class="roadshowinfo">
					
				</div>
			</div>
			<div class="left-bottom">
				<div class="left-bottom-title"><span style="margin-left: 10px;">车流车速</span></div>
				<div class="left-bottom-conditions">
					<div class="left-bottom-conditions1"></div>
					<div class="left-bottom-conditions2"></div>
					<div class="left-bottom-conditions3"></div>
					<div class="left-bottom-conditions4"></div>
				</div>
			</div>
		</div>
		<div class="right">
			<div class="btn" onClick="set()" id="btn"></div>
			<div id="iCenter" style="width:976px; margin-top:0px; z-index:100"></div>
		</div>
		<div class="linktop">
			<div style=" width:600px; height:15px;margin:0 auto; line-height:15px; margin-bottom:0px; border:0px; text-align:center; border-bottom: solid #DCDBE0 2px;">
				<span style="font-size:12px">友情链接:</span>
				<a href="http://www.zhjt.gov.cn/" target="_blank" style="text-decoration:none; background:url(../img/zhuhai.png) no-repeat;display: inline-block; padding-left: 17px;">
					<span style="font-size:12px">珠海市交通运输局</span>				
				</a>	
				<a href="http://www.zuche.com/" target="_blank" style="text-decoration:none; background:url(../img/szlogo.png) no-repeat;display: inline-block; padding-left: 27px;">
					<span style="font-size:12px">神州租车</span>				
				</a>
			</div>
		</div>
		<div class="linkfoot">
			<div style=" width:300px; height:15px;margin:0 auto; line-height:15px; text-align:center"><span style="font-size:12px">珠海市交通信息中心</span></div>
		</div>
	</div>
	
	
	<script type="text/javascript">
		//隐藏事件
		//var ig = document.getElementById("all");
		//var box = document.getElementById("left");
		var ig = $(".all").get(0);
		var box = $(".left").get(0);
		var btn = document.getElementById("btn");
		var w = box.offsetWidth;
		var isIE = (document.all) ? true : false;
		var isIE6 = isIE && ([/MSIE (\d)\.0/i.exec(navigator.userAgent)][0][1] == 6);
		var Bind = function(object, fun) {
			return function() {
				return fun.apply(object, arguments);
			}
		}
		ig.style.position = "fixed";
		ig.style.zIndex = '1000';
		ig.style.left = '0'+"px";
		ig.style.top = '0'+"px";
		if(isIE6){
			ig.style.position ="absolute";
			ig._fixed = Bind(ig, function(){
				ig.style.marginTop = document.documentElement.scrollTop  + "px";
			ig.style.marginLeft = document.documentElement.scrollLeft + "px";});
			ig._fixed()
			window.attachEvent("onscroll", ig._fixed);
		}
	
		function set(){
			if(ig.offsetLeft+w==0 || ig.offsetLeft+w==1)
			d(1);
			else
				d(-1);
			}
		function d(n){
			var T=setTimeout("d("+n+")",1);
			n=n<0?n-20:n+20
			ig.style.left=ig.offsetLeft+n+"px";
			if(ig.offsetLeft+w<=0){
				clearTimeout(T);
				ig.style.left = -w+"px";
				$(".all").css("width", $(".all").width() + 250);
				btn.style.backgroundImage = 'url(../img/right.png)';
			}
			if(ig.offsetLeft>=0){
				clearTimeout(T);
				ig.style.left=0;
				$(".all").css("width", $(".all").width() - 250);
				btn.style.backgroundImage = 'url(../img/left.png)';
			}
		}
	</script>
	
</body>
</html>